---
title: "High Unemployment and Inflation Rates were Strongly Correlated to Low Automobile Sales in the Early 1980s" 
author: "Tim Stephens"
date: "`r format(Sys.time(), '%d %B %Y')`"
thanks: "Code and data are available at: https://github.com/tim-stephens/Historic-Car-Sales-in-Canada.git."
abstract: 'The automobile industry has been the lifeblood of the Canadian economy since its inception in the early 20th century. Although domestic sales have generally increased over time, they were decimated in the early 1980s. Multiple oil crises in the 1970s led to skyrocketing oil prices, a global recession, and ultimately, high unemployment and inflation rates for Canadians. This paper will inspect the relationship between oil prices, unemployment, inflation, and automobile sales through the use of regression discontinuity design, linear regression, and multiple linear regression. It was found that unemployment and inflation rates had a strong correlation with automobile sales, but oil prices did not. \newline  \newline Keywords: Automobile, Car, Canada, Unemployment, Inflation, Oil, Sales, Economy \newpage' 
header-includes:
  - \usepackage{float}
  - \floatplacement{figure}{H}
output: pdf_document
bibliography: Car_Sales_In_Canada_bib.bib
toc: yes
---

```{r setup, include = FALSE, echo = FALSE, message = FALSE}

###SETUP###

library(tidyverse)
library(janitor)
library(tinytex)
library(here)
library(bibtex)
library(gridExtra)
library(huxtable)
library(knitr)
```

\pagebreak 
# 1.0 Introduction

## 1.1 History of the Automobile Industry in Canada 

|       Canada has a rich automotive history that is deeply connected to its economy. Between the first Canadian automobile produced in 1867 and the early United States (US) imports in 1898 (@CDNauto), Canada has been a player in the global market from the beginning. Canada welcomed the creation of Ford Motor Company of Canada Ltd in 1904, and by 1913, had roughly 50,000 vehicles on Canadian roads (@CDNauto). In the early 1920s, Canada had strengthened its hold on the market and was the second largest producer of vehicles in the world (@cvmaHistory). 

|       Nowadays, Canada is still a significant competitor in the automobile market. However, it is not the behemoth it once was. Canada is the 8th largest automobile producer globally and is the third largest exporter after Japan and the US (@CDNauto). Canada is home to many different manufacturing plants, such as Ford, General Motors, Toyota, Honda, and Fiat-Chrysler (@CarsMadeInCan). These plants make massive contributions to Canada’s manufacturing sector, representing 12% of manufacturing gross domestic product (GDP) and 24% of manufacturing trade (@CDNauto). The industry itself employs roughly 130,000 people, mostly located in Ontario, and indirectly employs another 370,000 (@cvmaFacts).

|       Canadians (and the Canadian economy) are dependent on automobiles. Every year, Canada exports \$65 billion worth of vehicles and $30 billion worth of parts (@CDNauto). The entire country has been built around the automobile, with cities being designed around roads, highways, and parking lots. There are currently over 35 million registered vehicles in Canada (@statsCan), nearly one registered car for every Canadian. Clearly, the automotive industry is a cornerstone in the Canadian economy. 

|       Although 80% of cars produced in Canada are exported (@CDNauto), the high ratio of cars to people means domestic sales still make significant contributions to the economy. Since the beginning, there has been consistent growth in national sales for the Canadian automobile industry – with a few exceptions (@newVehicleSales). In the early 1980s, there was a dramatic decrease in the number of new vehicles sold in Canada (@newVehicleSales). There are many factors that affect the number of vehicles sold in a country, but this paper will argue that high oil prices, unemployment rates, and inflation were related to the dramatic decrease of Canadian automobile sales during the early 1980s. 

&nbsp;

## 1.2 Important Events in the 1970s and 1980s 

|       The 1970s were a period that saw 2 significant oil crises, the second of which contributed to a global recession (@GlobalRecessions). After World War II, the Allied powers created the state of Israel in the Middle East. Since then, there have been numerous wars between the Arabic and Israeli people. One of these wars was the Yom-Kippur War. It began in 1973 when Egypt and Syria launched an attack on Israel (@HistoryChannel). The Soviet-Union supported Egypt and Syria and the US backed Israel (@HistoryChannel). As an act of retaliation, the Organization of Arab Petroleum Exporting Countries (OAPEC) significantly reduced their oil production and created an oil embargo on the US (@HistoryChannel). This ban on trade and reduced production dramatically affected the price of oil, from \$2.70 USD per barrel in 1973 to $11.00 in 1974 (@oilPrices). This increase in price was felt globally and was enough to send countries not directly affected by the embargo into an energy crisis (@HistoryChannel). Although the trade ban was lifted in 1974, the price of oil stayed relatively high and did not fall back to pre-embargo levels (@oilPrices). 

\newpage

|       In 1979, the second dramatic increase in the price of oil occurred. The Iranian Revolution started in 1978 and ended in 1979 with the Shah of Iran being ousted by Ayatollah Khomeini (@AutomotiveNews, @Investopedia). Khomeini drastically reduced oil production, which reduced global shipments of crude oil (@AutomotiveNews). Due to the reduced supply, gasoline prices skyrocketed. Prices more than doubled from 1978 - 1979, from \$12.79 USD per barrel to $29.19 (@oilPrices).

|       Partly because of the dramatic increase in the price of oil, Canada was plunged into a deep recession during the early 1980s. The Iranian Revolution, paired with new monetary policy, led to a sharp decline in US production and an increase in unemployment rates (@GlobalRecessions). Since the US and Canadian economies were so tightly linked, Canadians felt the impact of the US’ decreased production and saw a dramatic increase in the unemployment rate as well. In 1981, unemployment was at 7.6%, but by 1982, this number had jumped to 11.0% (@UnemploymentCan). As the CBC said, “If they’re not building homes in Boston, they’re not cutting timber in BC” (@CBC). The increase in price of oil and new monetary policy eventually led to increasing rates of inflation around the world – including Canada (@GlobalRecessions, @inflation). Currently, the Bank of Canada tries to keep inflation between 1 and 3% (@BOC). In the early 1980s, inflation was at just over 12% (@inflation). Combining the high inflation rate with a high unemployment rate meant Canadians were having difficulty purchasing groceries, heating their homes, and financing significant life events (@CBC). Without money for food, it is unlikely that many Canadians were considering purchasing new automobiles at this time. 

|       During the 1970s and early 1980s, domestic gas-guzzlers were the most popular car on the market (@AutomotiveNews). Smaller and more fuel-efficient Japanese cars were just starting to gain traction (@AutomotiveNews). Because favourite automobiles used a lot of gas, the price of gas was skyrocketing, inflation rates were increasing, and people could not find jobs, “consumer confidence evaporated” (@AutomotiveNews), and automobile sales were decimated in the early 1980s. 

&nbsp;

## 1.3 Structure of paper and method of analysis

|       This paper will try to confirm the research above using datasets provided by various sources, which are discussed in the next section. A surface level investigation into Canadian automobile sales, world oil prices, unemployment rates, and inflation levels will be done next. After, four regression discontinuity design (RDD) models will be constructed to observe the dip in sales during the early 1980s. Three separate linear regression models will then be constructed with vehicle sales as the dependent variable and oil prices, unemployment rate, and inflation rate used as the independent variables. A multiple linear regression model will also be created. The paper will then discuss results, key findings, ethics, weaknesses, and some next steps. Although this study looks to draw a link between vehicle sales, oil prices, unemployment rates, and inflation, it will not be able to speak to causality of the dramatic decrease in automobile sales during the early 1980s. The reasoning behind why causality cannot be determined will be talked about in the discussion section, after key findings.  

\newpage

# 2.0 Data

## 2.1 Datasets used 
|       In this analysis, four datasets were used. First, the "New Motor Vehicle Sales" dataset was used to determine the number of new vehicles sold in Canada (@newVehicleSales). Published by the Government of Alberta, this dataset records monthly provincial and national vehicle sales as far back as 1946; however, provincial data was not available until 1968. It was last updated in 2015, but the year was not complete. In order to allow for overlap with other datasets, only national data from 1960 to 2014 were included and monthly vehicle sales were converted to yearly sales. This data comes from a reputable source, but only recorded new vehicle sales. Used automobile sales and gifted vehicles were not included in this analysis. 

```{r Cars,  echo = FALSE, message = FALSE, include = FALSE}

#read in the data
cars <- read_csv(here("inputs/data/newmotorvehiclesales.csv"))

#trim car sales data to what we need (exclude provinces)
cars_canada <- 
  cars %>% 
  select(When, Vehicle, Canada) %>% 
  mutate(date_when = as.Date(When, format="%m/%d/%Y")) %>% #convert to date format
  mutate(Year = format(date_when, "%Y"))
```

```{r functions, echo = FALSE, message = FALSE, include = FALSE}

###FUNCTIONS###

# GOAL: group sales of trucks, cars, and total sales by year instead of month


# Total Truck Yearly Sales
total_trucks <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Trucks") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }
    

# Total Car Yearly Sales
total_cars <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Passenger cars") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }


# Total Sales
total_totals <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Total, new motor vehicles") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }

```


```{r Yearly Vehicle Sales, echo = FALSE, message = FALSE, include = FALSE}

#Prepare the data frame for yearly vehicle sales
yearly_vehicle_sales = data.frame()

#run through every year (1960 - 2014), calculate the total yearly sales, add it to the data frame
  for (i in 1960:2014) {
    x <- total_trucks(i)
    y <- total_cars(i)
    z <- total_totals(i)
    newrow <- data.frame(Year = i, Trucks = x, Cars = y, Total = z)
    yearly_vehicle_sales <- rbind(yearly_vehicle_sales, newrow)
  }


#write to csv for local safekeeping
write_csv(yearly_vehicle_sales, here("inputs/data/yearly_vehicle_sales.csv"))


```

|       The second dataset used was historical oil prices from 1960 to 2021 (@oilPrices). The dataset was pulled from Statista and was published by Mineralölwirtschaftsverband (MWV), a German company which "[represents] the petroleum industry in legal matters, particularly in the preparation of laws and regulations" (@MWV). MWV monitors world oil prices, particularly the price of crude oil from the Organization of the Petroleum Exporting Countries (OPEC). In order to fit with other data used in this study, only the years 1960 to 2014 were selected. There were some discrepancies between this dataset and the study. This dataset monitors the oil price from OPEC -- not historic Canadian prices. Unfortunately, data on historical Canadian oil prices (within the right time frame) could not be found. Regardless, trends are related between the two, and OPEC prices will hold as a valid substitute. 


```{r Oil, echo = FALSE, message = FALSE, include = FALSE}

#read in data
oil <- read_csv(here("inputs/data/OPEC_Historic_Oil_Prices_Statista_CSV.csv"))

#Trim oil price range to match that of car data (up to 2014)
oil_trimmed <- 
  oil %>% 
  filter(`OPEC oil price annually 1960-2021` <= 2014) %>% 
  rename(c('Year' = 'OPEC oil price annually 1960-2021')) %>% 
  rename(c('price_in_usd' = "X2"))

#Change oil price year from character to numeric
oil_trimmed$Year <- as.numeric(as.character(oil_trimmed$Year))
```

|       The third dataset used for this analysis was for Canadian unemployment rates (@UnemploymentCan). The dataset was published by Statistics Canada, drawing on information learned from Labour Force Surveys. Information from 1976 - 2018 was collected, which was all that was available. The original dataset was large, holding information about the entire labour force. It was trimmed so that only national unemployment rates were selected. In terms of demographics, unemployment rates for both sexes above the age of 15 were selected. This was chosen in order to get a good idea of how Canada's labour force was functioning at the time of interest. It is noted, though, that it is unlikely that a 15 year old would purchase a new vehicle. 

```{r Unemployment, echo = FALSE, message = FALSE, include = FALSE}

#read in data
unemployment <- read_csv(here("inputs/data/unemployment_rates_can.csv"))

#Cleaning the unemployment rate data set
unemployment_cleaned <- 
  unemployment %>%
  clean_names() %>% 
  filter(geo == 'Canada' & 
           sex == 'Both sexes' & 
           age_group == '15 years and over' & 
           labour_force_characteristics == 'Unemployment rate') %>% 
  select(c(ref_date, geo, labour_force_characteristics, age_group, sex, value ))

#trim to columns of interest
unemployment_trimmed <- 
  unemployment_cleaned %>% 
  select(c(ref_date, value)) %>% 
  rename(c('Year' = 'ref_date')) %>% 
  rename(c('unemployment_rate' = 'value'))

```

|       The last dataset was created by the analyst. Data was pulled from inflation.eu (@infeu1). Inflation.eu "contains current and historic data about inflation and the consumer price index", citing Statistics Canada as its source for Canadian data (@infeu2). Data was copied from the historic data web page into a csv file in order to run the analysis.

```{r Inflation, echo = FALSE, message = FALSE, include = FALSE}

#read in data
inflation_rates <- read_csv(here("inputs/data/Inflation_Rates_sourced.csv"))

#Inflation Rates Cleaning 
inflation_rates_cleaned <- 
  inflation_rates %>% 
    filter(Year <= 2014 & Year >= 1960)


inflation_rates_cleaned$inflation_rate <- 
  as.numeric(as.character(inflation_rates_cleaned$inflation_rate))

```

&nbsp;

## 2.2 How Data was Analyzed 
|       Data was analyzed using R(@R). Many packages were used to study the data, with tidyverse doing much of the heavy lifting (@tidyverse). Janitor (@Janitor) was used to clean datasets. Here (@here) helped in locating and saving files. Ggplot2 (@ggplot2), gridExtra (@gridExtra), and huxtable (@hux) were used to create graphs, figures, and tables. Tinytex (@tinytex) was used to help write the output to PDF and bibtex (@bibtex) was used for citations. 

\newpage

## 2.3 Show me the money! 

|       First, automobile sales in Canada were investigated. Figure 1 shows new yearly car sales in Canada from 1960 to 2014. 

```{r Car Sales, fig.cap="Historical Car Sales in Canada", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
options(scipen=999) #removes scientific notation

ggplot(yearly_vehicle_sales, aes(x = Year, y = Cars)) +
  theme_minimal() + 
  geom_point() +
  geom_line() + 
  labs(x = "Year", 
       y = "Number of New Cars Sold",
       title = "
       Car Sales Generally Increased from 1960 to 1985, 
       With a Significant Drop in 1982") 

```
|       Car sales generally increased from the period of 1960 to 1985, with a few dramatic drops in sales. There was a decrease in 1970 and in the early 1980s, but the drop in the '80s was much more sudden and dramatic. This is the area of interest for the study. After 1985, sales started to decrease until the mid 1990s, when sales slowly started to increase again. Sales leveled out for a few years, but eventually decreased just before 2010. This drop in sales could be attributed to the stock market collapse of 2008, but falls outside the scope of this study. Figure 2 shows Canadian truck sales between 1960 and 2014. The trend is more positive than that of Figure 1. 


```{r Truck Sales, fig.cap="Historical Truck Sales in Canada", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
options(scipen=999) #removes scientific notation

ggplot(yearly_vehicle_sales, aes(x = Year, y = Trucks)) +
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Number of New Trucks Sold",
       title = "
       Truck Sales Have Had Consistent Growth Since 1960")


```
|       Canadian truck sales have done significantly better than Canadian car sales. The trend has been overwhelmingly positive, and the market has steadily grown since 1960. Although the market sees dips in sales at the same time as car sales (1970, early 1980s, 1990s, and just before 2010), the changes are not as dramatic. The truck market is apparently less volatile than the car market in Canada. However, the number of new trucks sold is not as high as the number of new cars sold. The market is smaller, but more stable. Although comparing the Canadian car and truck markets is interesting, the total number of vehicles sold in Canada was used for this analysis. Figure 3 shows the combined sales of cars and trucks. 

```{r Vehicle Sales, fig.cap="Historical Total Automobile Sales in Canada", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
options(scipen=999) #removes scientific notation

ggplot(yearly_vehicle_sales, aes(x = Year, y = Total)) +
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Total Number of New Vehicles Sold",
       title = "
       The Total Number of Vehicles Sold in Canada has Seen Steady 
       Growth, but had a Sudden Decrease in Sales from 1979 - 1982")


```
|       The combined plot looks as one might expect: similar to the car sales plot, with less dramatic peaks and troughs. The truck sales have made the market less volatile. For the rest of this paper, this will be the dataset used when discussing vehicle sales in Canada. Now that sales of vehicles is known, independent variables of interest were selected to see if they were related to sales. The first is historic oil prices. Although Canadian oil prices could not be found in the correct time frame, world oil prices follow similar trends, and will be sufficient for this study. Figure 4 shows historic oil prices of OPEC crude oil. 
```{r Oil Plot, fig.cap="Historical Oil Prices", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}

ggplot(oil_trimmed, aes(x = Year, y = price_in_usd )) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() +
  #theme(axis.text.x = element_text(angle = 90)) + 
  scale_y_continuous(labels=scales::dollar_format())+
  labs(x = "Year", 
       y = "OPEC Price of Oil per Barrel (in USD)", 
       title = "
       OPEC World Oil Prices had 2 Price Hikes in the 1970s")


```
|       As discussed in the introduction, world oil prices saw 2 significant increases in the 1970s. The first was between 1973 and 1974, and the second was between 1978 and 1979 -- although prices peaked in 1980. After that, oil prices stayed relatively constant before deceasing between 1985 and 1986. Oil prices then remained stable before undergoing a period of dramatic increase starting around the year 2000. For the purposes of this study, the period of interest is the 1970s and early 1980s. The increase starting in the year 2000 will not be investigated. Another factor thought to affect new automobile sales was the unemployment rate. Trends for this variable are shown in Figure 5. 

```{r Unemployment Plot, fig.cap="Unemployment Rates in Canada", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}

ggplot(unemployment_trimmed, aes(x = Year, y = unemployment_rate )) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  scale_y_continuous(labels=scales::percent_format(scale = 1)) +
  xlim(1975, 2020) +
  labs(x = "Year", 
       y = "Unemployment Rate",
       title = "
       Unemployment Rates in Canada Peak at 12% in 1983")

```
|       Unemployment data was only available from 1976, so the x axis scale is different than Figures 1-4. Unemployment rates have fluctuated over time, and it is normal for countries to experience periods with high unemployment. There were two dramatic peaks for Canadians: 1983 and 1993. 1983 saw the highest unemployment rate at 12%. This is an extremely interesting point, as it falls within the scope of the study. The last variable studied was inflation rate. Historic levels are shown in Figure 6. 


```{r Inflation Plot, fig.cap="Inflation Rates in Canada", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}

ggplot(inflation_rates_cleaned, aes(x = Year, y = inflation_rate)) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  scale_y_continuous(labels=scales::percent_format(scale = 1)) +
  labs(x = "Year", 
       y = "Inflation Rate",
       title = "Inflation Rates in Canada were Historically High Between 1972 and 1983")

```

|       As stated in the intro, the Bank of Canada tries to keep inflation between 1 and 3%, which can be seen from 1991 onward. Before then, inflation seemed to run wild, peaking in 1974 with inflation at 12.65%. Inflation was also very high during the period of interest, with inflation at 12.12% in 1981 (@infeu1). To easily compare all variables, Figure 7 was created. It shows the total number of vehicle sales, world oil prices, unemployment rates, and inflation rates. 


```{r All Plots of Interest Together, fig.cap="Total Automobile Sales, Oil Prices, Unemployment Rates, and Inflation Rates", echo = FALSE, message = FALSE, fig.align='center', out.width="75%", out.height="75%"}

vehicle_plot <- 
  ggplot(yearly_vehicle_sales, aes(x = Year, y = Total)) +
  theme_minimal() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Number of Vehicles Sold",
       title = "Total Vehicles Sold")

oil_plot <- 
  ggplot(oil_trimmed, aes(x = Year, y = price_in_usd )) + 
  theme_minimal() + 
  geom_line() +
  #theme(axis.text.x = element_text(angle = 90)) + 
  scale_y_continuous(labels=scales::dollar_format())+
  labs(x = "Year", 
       y = "Price (USD)", 
       title = "OPEC World Oil Prices")

unemployment_plot <-
  ggplot(unemployment_trimmed, aes(x = Year, y = unemployment_rate )) + 
  theme_minimal() + 
  geom_line() + 
  scale_y_continuous(labels=scales::percent_format(scale = 1)) +
  labs(x = "Year", 
       y = "Unemployment Rate",
       title = "Unemployment Rates")
  
  
inflation_plot <- 
  ggplot(inflation_rates_cleaned, aes(x = Year, y = inflation_rate)) + 
  theme_minimal() + 
  geom_line() + 
  scale_y_continuous(labels=scales::percent_format(scale = 1)) +
  labs(x = "Year", 
       y = "Inflation Rate",
       title = "Inflation Rates")
  
grid.arrange(vehicle_plot, oil_plot, unemployment_plot, inflation_plot, 
             ncol = 2, 
             top = "              In the early 1980s, car sales were low,the price of oil was high, 
             and unemployment and inflation rates were skyrocketing
             ")



```
|       Figure 7 shows some preliminary relationships. It appears that in the early 1980s, vehicle sales were low. At the same time, oil prices had seen a significant increase, unemployment rates were very high, and inflation rates were at just over 12%. With everything lining up, it seems as if all 4 of these variables were related in some way. To investigate the drop in vehicle sales, four RDD models were created. They are shown in the next section. Linear models were also constructed to determine if the 4 variables were statistically correlated. 

&nbsp;

# 3.0 Model 

## 3.1 Regression Discontinuity Design 

|       To further investigate the dramatic drop in sales during the early 1980s, four different RDD models were created. Each model had year on the x axis and vehicle sales on the y axis. Each individual variable was inspected, and the year where the peak or trough occurred (within the time frame of the study) was chosen as the distinct cutoff point for the model. Oil prices peaked in 1980, unemployment rates were highest in 1983, inflation was high in 1981, and vehicle sales were lowest in 1982. Figure 8 shows an RDD model with 1980 as the cutoff, representing the year when oil prices were relatively high. 


```{r RDD1980, fig.cap="RDD for Oil Prices", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}

#Total RDD split on year

yearly_vehicle_sales %>% 
  ggplot(aes(x = Year,
             y = Total)) +
  geom_point(alpha = 0.2) +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year < 1980), 
              method='lm',
              color = "black") +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year >= 1980), 
              method='lm',
              color = "black") +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Vehicles Sold",
       title = "
       RDD Model With a Cutoff Point at 1980, 
       the Year Oil Prices were Highest")
```
|       The RDD model with 1980 selected as a cutoff point shows a distinct drop in automobile sales. The light grey bars represent error, and this plot does not have any overlap. This shows that the year of 1980 did have a significant drop in automobile sales when compared to pre-1980 levels. However, there were many factors at play during the year of 1980, so there is not enough evidence to show that oil prices alone are what caused a dramatic drop in sales. Another possible factor in the drop in sales was unemployment, which is inspected next. Figure 9 shows an RDD for the year unemployment was at its highest: 1983. 

```{r RDD1983, fig.cap="RDD for unemployment prices", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}


yearly_vehicle_sales %>% 
  ggplot(aes(x = Year,
             y = Total)) +
  geom_point(alpha = 0.2) +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year < 1983), 
              method='lm',
              color = "black") +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year >= 1983), 
              method='lm',
              color = "black") +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Vehicles Sold",
       title = "
       RDD Model With a Cutoff Point at 1983, 
       the Year Unemployment Rates were Highest")

```

|       Figure 9 shows a drop in sales during the year of 1983, but there is significant overlap in the error bars in this model. 1983 is not a good year to represent the dramatic drop in automobile sales in the early 1980s. After inspecting the dataset, it appears that automobile sales started to rebound in 1983. Nonetheless, the effects of unemployment on vehicle sales will still be inspected using a linear model in the next section. The next variable of interest is inflation, which had its highest value in 1981. Figure 10 shows an RDD model with 1981 as the cutoff point, representing the year inflation was high. 

```{r RDD1981, fig.cap="RDD for inflation", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}


yearly_vehicle_sales %>% 
  ggplot(aes(x = Year,
             y = Total)) +
  geom_point(alpha = 0.2) +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year < 1981), 
              method='lm',
              color = "black") +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year >= 1981), 
              method='lm',
              color = "black") +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Vehicles Sold",
       title = "
       RDD Model With a Cutoff Point at 1981, 
       the Year Inflation was at its Highest")

```
|       Figure 10 shows a significant drop in automobile sales during 1981, but there are many different factors at work behind the scenes, and it cannot be said with confidence that inflation is what caused the drop in sales. Nonetheless, the error bars do not overlap in this model, showing that the year of 1981 saw significant drops in automobile sales when compared to pre-1981 levels. The final RDD model was when vehicle sales were at their lowest: 1982. Figure 11 shows this model. 

```{r RDD1982, fig.cap="RDD for Sales", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}


yearly_vehicle_sales %>% 
  ggplot(aes(x = Year,
             y = Total)) +
  geom_point(alpha = 0.2) +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year < 1982), 
              method='lm',
              color = "black") +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year >= 1982), 
              method='lm',
              color = "black") +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Vehicles Sold",
       title = "
       RDD Model With a Cutoff Point at 1982, 
       the Year Automobile Sales were at their Lowest")


```
|       When selecting 1982 as the cutoff point, the results are similar to that of 1980 and 1981. The error bars do not overlap, and there is a significant drop in automobile sales. It is likely that all 3 factors contributed to this dramatic drop in sales in 1982. It is important to note that even though unemployment did not have a significant and clear finding, unemployment rates were high in 1982 as well. The auto industry had started to rebound by 1983, after a period of low sales during 1980-1982. These different RDD models show that the years of 1980, 1981, and 1982 all saw a significant drop in sales when compared to pre 1980 levels. What caused the low sales cannot be determined with these RDD models, though, as they use year as the independent variable. A year itself cannot cause a drop in sales. Events that occurred during a given year are what give rise to change. A deeper discussion of causality will occur later in the paper. Linear models are developed in the next section to see if the variables are statistically correlated to sales. 

\newpage

## 3.2 Linear Models 
|       In this section, three linear regression models and one multiple linear regression model were constructed. Linear models for each variable of interest were created to inspect their correlation to automobile sales. Then, all three were combined to see if any changes occurred. The first linear model created was for oil prices. Figure 12 shows a visualization of the data, and Table 1 shows the linear regression results. 

```{r Linear Model Oil Price Car Sales, echo = FALSE, include = FALSE, message = FALSE}

#For all years: 

lm_data_oil_yearly_vehicle_sales <- 
  inner_join(yearly_vehicle_sales, oil_trimmed, by = "Year")

linear_model_oil_and_sales <- 
  lm(Total ~ price_in_usd, lm_data_oil_yearly_vehicle_sales)

summary(linear_model_oil_and_sales)

```

```{r Linear Model Oil Price Car Sales plot, fig.cap="Linear Model for Oil and Auto Sales", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
ggplot(lm_data_oil_yearly_vehicle_sales, aes(x = price_in_usd, y = Total)) +
  geom_point() +
  geom_smooth(method = 'lm', col = 'blue') + 
  theme_minimal() + 
  scale_x_continuous(labels=scales::dollar_format())+
  labs(x = "Price of Oil (USD)",
       y = "Total Number of Vehicles Sold",
       title = "As the Price of Oil Increases, Automobile Sales Also Increase")


```
&nbsp;

```{r Table 1, fig.cap="Linear Regression Results for Oil and Auto Sales", echo = FALSE, message = FALSE, fig.align='center'}

huxreg(" " = linear_model_oil_and_sales,
       coefs = c("Intercept" = "(Intercept)", 
                 "Oil Price (USD)" = "price_in_usd"),
       statistics = c("Number of Observations" = "nobs",
                      "R Squared" = "r.squared",
                      "P Value" = "p.value"),
       error_pos = 'right') %>% 
  set_italic(final(1),1) %>% 
  set_caption("Linear regression of automobile sales and oil prices") %>% 
  add_footnote("Values in parentheses represent standard error")
```
&nbsp;

\newpage

|       Interestingly, oil prices are positively correlated with vehicle sales. Looking at the results of Table 1, it is clear that for every one unit increase in the price of oil, 7991 more cars will be sold! With a p value < 0.001, this is a significant (and unexpected) finding, that contradicts the research done above. Even though car sales are positively correlated with oil prices, it is not a be-all-end-all finding. As stated in the introduction, the oil crisis of the late 1970s is what launched Canada into a recession, leading to increasing unemployment and inflation. To better the insights derived from this model, a multiple linear regression model will be done to control for unemployment and inflation. The next linear model prepared was for of unemployment rates and total automobile sales. Results are shown in Figure 13 and Table 2. 

```{r Linear Model unemployment and sales, echo = FALSE, include = FALSE, message = FALSE}

oil_sales_unemp_dataset <- 
  inner_join(unemployment_trimmed, lm_data_oil_yearly_vehicle_sales, by = "Year")

unemployment_rate_lm_sales <- 
  lm(Total ~ unemployment_rate, oil_sales_unemp_dataset )

summary(unemployment_rate_lm_sales)


```

```{r Linear Model unemployment Car Sales plot, fig.cap="Linear Model for Unemployment and Auto Sales", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
ggplot(oil_sales_unemp_dataset, aes(x = unemployment_rate, y = Total)) +
  geom_point() +
  geom_smooth(method = 'lm', col = 'blue') +  
  theme_minimal() + 
  scale_x_continuous(labels=scales::percent_format(scale = 1)) +
  labs(x = "Unemployment Rate", 
       y = "Total Number of Vehicles Sold",
       title= "As Unemployment Rates Increase, Automobile Sales Decrease")
```
&nbsp;

```{r Table 2, fig.cap="Linear Regression Results for Unemployment and Auto Sales", echo = FALSE, message = FALSE}

huxreg(" " = unemployment_rate_lm_sales,
       coefs = c("Intercept" = "(Intercept)", 
                 "Unemployment Rate" = "unemployment_rate"),
       statistics = c("Number of Observations" = "nobs",
                      "R Squared" = "r.squared",
                      "P Value" = "p.value"),
       error_pos = 'right') %>% 
  set_italic(final(1),1) %>% 
  set_caption("Linear regression of automobile sales and unemployment rates") %>% 
  add_footnote("Values in parentheses represent standard error")
```
\newpage

|       Figure 13 and Table 2 show a negative correlation between unemployment rate and automobile sales. Essentially, as unemployment rates rise, automobile sales are expected to fall. The linear regression model in Table 2 shows that for every one unit increase in unemployment rate, 95,225 less vehicles will be sold. With a p value less than 0.001, this is a significant finding. Unemployment rate and vehicle sales are related. Further analysis will be done in the multiple regression to confirm this finding. 

|       The final two-way relationship studied was inflation rate and sales. Data visualization is shown in Figure 14, and the linear model results are shown in Table 3. 

```{r Linear Model Inflation and sales, echo = FALSE, include = FALSE, message = FALSE}

#Inflation testing 

oil_sales_unemp_inf_dataset <- 
  inner_join(oil_sales_unemp_dataset, inflation_rates_cleaned, by = "Year")

linear_model_inflation_sales <- 
  lm(Total ~ inflation_rate, oil_sales_unemp_inf_dataset)

summary(linear_model_inflation_sales)

```

```{r Linear Model inflation Car Sales plot, fig.cap="Linear Model for Inflation and Auto Sales", echo = FALSE, message = FALSE, fig.align='center', out.width="65%", out.height="65%"}
ggplot(oil_sales_unemp_inf_dataset, aes(x = inflation_rate, y = Total)) +
  geom_point() +
  geom_smooth(method = 'lm', col = 'blue') +  
  theme_minimal() +
  scale_x_continuous(labels=scales::percent_format(scale = 1)) +
  labs(x = "Inflation",
       y = "Total Number of Vehicles Sold",
       title = "As Inflation Increases, Automobile Sales Decrease")


```
&nbsp;

```{r Table 3, fig.cap="Linear Regression Results for Inflation and Auto Sales", echo = FALSE, message = FALSE}

huxreg(" " = linear_model_inflation_sales,
       coefs = c("Intercept" = "(Intercept)", 
                 "Inflation Rate" = "inflation_rate"),
       statistics = c("Number of Observations" = "nobs",
                      "R Squared" = "r.squared",
                      "P Value" = "p.value"),
       error_pos = 'right') %>% 
  set_italic(final(1),1) %>% 
  set_caption("Linear regression of automobile sales and inflation rate") %>% 
  add_footnote("Values in parentheses represent standard error")

```
\newpage

|       Figure 14 shows another negative correlation. As inflation rates rise, total new vehicle sales are expected to decrease. Specifically, for every one unit increase in inflation rate, 32,329 less vehicles are expected to be sold. With a p value less than 0.01, this value is a significant finding. Inflation rates and vehicle sales are negatively correlated. This finding will be confirmed with the multiple linear regression model. 

|       Lastly, a multiple linear regression model was prepared. Interestingly, the results were not the same when compared to each individual model. Results are shown in Table 4. 

```{r Multiple Linear Regression, echo = FALSE, include = FALSE, message = FALSE}

multiple_lm_model_all_3 <- 
  lm(Total ~ unemployment_rate + price_in_usd + inflation_rate, 
     data = oil_sales_unemp_inf_dataset)

summary(multiple_lm_model_all_3)



```

```{r Table 4, fig.cap="multiple linear regression", echo = FALSE, message = FALSE}
huxreg(" " = multiple_lm_model_all_3,
       coefs = c("Intercept" = "(Intercept)",
                 "Oil Price (USD)" = "price_in_usd",
                 "Unemployment Rate" = "unemployment_rate",
                 "Inflation Rate" = "inflation_rate"),                
       statistics = c("Number of Observations" = "nobs",
                      "R Squared" = "r.squared",
                      "P Value" = "p.value"),
       error_pos = 'right') %>% 
  set_italic(final(1),1) %>% 
  set_caption("Multiple linear regression of automobile sales, oil prices, unemployment rate, and inflation rate") %>% 
  add_footnote("Values in parentheses represent standard error")
```
|       After creating a multiple linear regression model, some interesting findings appear. With p values less than 0.001, unemployment rate and inflation are negatively correlated with total vehicle sales. However, the price of oil is no longer significantly related to automobile sales. A deeper discussion will occur in the next section, but it appears that oil prices are no longer a predictor of vehicle sales after controlling for unemployment and inflation. 

# 4.0 Results

|       There were a lot of results in this analysis. First, it was found that the Canadian truck market was far less volatile than the Canadian car market. After combining the two into one sales figure, it was found that a significant drop in sales occurred in 1982. Next, three variables were inspected at the surface level: OPEC oil prices, unemployment rates, and inflation rates. It was found that all three had significant increases around the same time automobile sales plummeted. Next, four RDD models were created for each year the variable of interest had its peak. For oil prices, a cutoff point of 1980, unemployment rates had a cutoff of 1983, inflation was 1981, and automobile sales were 1982. There was clear separation for oil, inflation, and auto sales, as there was no overlap of error bars. Small overlap of error bars occurred when 1983 was used, but it is possible automobile sales had started to recover after multiple years of low sales. Next, linear regression models were created. Initially, there was significant correlation for all three variables. Oil was positively correlated, and the other two were negatively correlated. However, when putting all three variables together into one multiple linear regression model, oil prices lost their significance. Why?


|       As discussed in the textbook "An Introduction to Statistical Learning with Applications in R" (@james), this is a common occurrence. A classic example has to do with temperature, sharks, and ice-cream sales. As stated in the textbook: 

&nbsp;

|       Running a regression of shark attacks versus ice cream sales for data collected at a given
|       beach community over a period of time would show a positive relationship, similar to that 
|       seen between sales and newspapers. Of course no one (yet) has suggested that ice creams 
|       should be banned at beaches to reduce shark attacks. In reality, higher temperatures cause 
|       more people to visit the beach, which in turn results in more ice cream sales and more shark
|       attacks. A multiple regression of attacks versus ice cream sales and temperature reveals 
|       that, as intuition implies, the former predictor is no longer significant after adjusting for
|       temperature (@james).
  
&nbsp;
  
|       In the scenario of automobile sales, oil prices, unemployment rates, and inflation, oil prices are no longer significant after adjusting for unemployment rates and inflation. Oil prices are not a direct predictor of Canadian automobile sales. However, this is not to say that oil prices are unimportant to the story of the declining market in the early 1980s. As stated in the introduction, the dramatic increase in the price of oil is what launched Canada into a recession. This recession gave rise to high inflation and high unemployment. So, even though oil is not directly correlated to auto sales after controlling for inflation and unemployment, it does affect other factors which are directly correlated to sales. 

&nbsp;

# 5.0 Discussion 

## 5.1 Key Findings
|       In this paper, it was discovered that even though oil prices seem to be related to car sales, they are not. They do, however, indirectly affect other factors that are associated with automobile sales. It was found that unemployment and inflation are significantly correlated to automobile sales, with both of them having negative associations. Intuitively, these results make sense. If people are not working, they are not likely to have the income to purchase a new vehicle. Additionally, if their dollar is worth \$1.00 one year and \$0.88 the next, it is unlikely they will be able to afford a new vehicle since their money is no longer worth what it once was.

&nbsp;

## 5.2 Causality 
|       Even though this paper speaks to correlation, it is not able to speak to causality. RDD models are generated to show causality between two variables using a specific cutoff point. The variable used as the cutoff point is the reason as to why there is a large increase or decrease in the dependent variable. For example, someone who gets a 90% average is not that different from someone who has an 89% average, but are students with a 90% average more likely to be accepted into universities? In this case, an RDD model could be created with grades on the x axis and university acceptance rates on the y axis. If rates underwent a significant jump at 90%, then it could be inferred that increased acceptance rates were due to someone receiving a 90% instead of an 89%. In this study, though, a time was used. Time itself cannot be used for causation. A year is not a reason for something to happen. Multiple things occur in any given year, and it is those variables that cause drops in dependent variables. In this study, RDD was used to inspect different years in the early 1980s that experienced drops in car sales. The other variables are what led to the drop in car sales, not the year. However, the other variables did not have a distinct cutoff point to examine, and thus, an RDD model could not be designed to inspect causality between oil prices, unemployment rates, inflation, and vehicle sales.

|       After conducting research into the socioeconomic factors of the 1970s and early 1980s, it is likely that the skyrocketing oil prices are what led to the Canadian recession, ultimately increasing unemployment rates and inflation. With no jobs and their money being worth less than it was in the past, Canadians were not in the market to purchase new vehicles. The multiple linear regression model supports this hypothesis, as oil prices lose significance after controlling for unemployment and inflation, and unemployment and inflation are significantly associated with automobile sales. However, statistically speaking, there is no evidence to show that the increased price of oil is what caused increased unemployment and inflation.  

&nbsp;

## 5.3 Ethics
|       As with any statistical study, possible ethical concerns can arise. On a local scale, the dataset used for automobile sales only focused on the purchase of new vehicles. Lots of Canadians will never purchase a new vehicle in their life. Those in lower socioeconomic classes were therefore not included in the study. People in this category (who live paycheck-to-paycheck) are likely more focused on the price of gasoline. For them, a doubling in the price of gas could be a reason for them to not purchase a vehicle. Those who can afford a new vehicle may be less likely to care so much about the price of oil, and not take it into consideration when purchasing a vehicle. 

|       On a larger scale, it seems bizarre to leave so much power in the hands of oil companies. They have the ability to launch a global recession if they increase the price of oil by too much. Additionally, as more people become dependent on automobiles for their everyday life, these oil companies have the ability to hike prices, as they know people will have to pay. If oil is indeed a necessity, then there should be rules and regulations stopping rapid increases in price.

&nbsp;

## 5.4 Weaknesses
|       This study proved to have some interesting findings, but it did have its weaknesses. As mentioned above, it only focused on the sales of new automobiles, leaving out an entire socioeconomic class from the study. It used inflation and unemployment rates from datasets who cite Statistics Canada, but the data is not directly from the source. It is unlikely, but possible, that this data was not 100% accurate. Additionally, oil prices were reported as world oil prices, not Canadian oil prices, which could have led to different results. However, Canadian prices will always be related to the OPEC price, and the results would likely be similar. Finally, the study cannot speak to causality due to choosing time to be the independent variable in the RDD model, and other variables not having a distinct cutoff point. 

&nbsp;

## 5.5 Next Steps
|       For this time period in particular, the next steps would be to determine if the doubling of oil prices are what caused the increase in unemployment and inflation rates. Based on historical evidence, this is likely, but having statistical evidence would increase the credibility of this statement. Although an RDD design would not be possible, other statistical methods could be used. After determining if oil caused the rise in unemployment and inflation, it should be determined if unemployment and inflation did, in fact, cause a decrease in automobile sales. For now, they are merely correlated variables. 


|       Next, it would be interesting to inspect what was happening in the 1990s, and just before 2010. Automobile sales also decreased during these times, and it would be interesting to see if the same factors were correlated with the decrease in sales (unemployment and inflation). 

|       Finally, it would be beneficial to be able to construct a model with causality to predict automobile sales. More variables are likely needed, although inflation rates and unemployment are a good start. 

&nbsp;

# 6.0 Conclusion 
|       This paper inspected a specific time frame of Canadian automobile sales. Although the sector has seen general growth since its inception, there have been a few periods of drastic decreases in sales, such as the early 1980s. After doing some literature review, three variables of interest were determined: oil prices, unemployment rates, and inflation rates. Each variable was inspected at a surface level, and it was found that oil prices doubled in the late 1970s and both unemployment and inflation were high during the early 1980s. RDD models were designed to see the drop in sales in the early 1980s, showing that there was a significant change in automobile sales during this time. After, linear models were produced, with each factor being significantly correlated to auto sales individually. But, after running a multiple linear regression, it was determined that oil was merely taking credit for the affects of unemployment and inflation rates. It was found that after controlling for unemployment and inflation, oil prices were no longer correlated to auto sales. Although this paper cannot speak to causality from a statistical point of view, it is likely that the doubling of oil prices in the late 1970s triggered a recession in Canada, ultimately leading to high unemployment and inflation rates which are correlated to low automobile sales. In the future, models will be designed to determine if oil is, in fact, what caused an increase in inflation and unemployment, and if unemployment and inflation are what caused the decrease in automobile sales. For now, it can only be stated that these factors are correlated to one another. Additionally, other time periods will be studied to further increase the strength of the model, with the goal of predicting future automobile sales using multiple variables. Unemployment rates and inflation is a good start, but other socioeconomic factors likely affect sales as well. 

\newpage
# References





