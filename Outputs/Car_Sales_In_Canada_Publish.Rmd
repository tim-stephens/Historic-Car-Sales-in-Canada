---
title: "High Oil Prices and Unemployment Rates Contributed to Unusually Low Canadian Automobile Sales in 1982" 
author: "Tim Stephens"
date: "`r format(Sys.time(), '%d %B %Y')`"
thanks: "Code and data are available at: https://github.com/tim-stephens/Historic-Car-Sales-in-Canada.git."
abstract: 'The automobile industry has been the lifeblood of the Canadian economy since its inception in the early 20th century. Although domestic sales have generally increased over time, they were decimated in the early 1980s. Multiple oil crises in the 1970s led to skyrocketing oil prices, a global recession, and ultimately, a high unemployment rate for Canadians. With an increased price of fuel and a reduced number of jobs available, Canadian automobile manufacturers saw a dramatic decrease of sales in 1982. \newline  \newline Keywords: Automobile, Car, Vehicle, Canada, Unemployment, Oil, Sales, Economy \newpage' 
output: pdf_document
bibliography: Car_Sales_In_Canada_bib.bib
toc: yes
---

```{r setup, include = FALSE, echo = FALSE, message = FALSE}

###SETUP###

library(tidyverse)
library(janitor)
library(tinytex)
library(here)
library(bibtex)
library(gridExtra)
```

\pagebreak 
# 1.0 Introduction

&nbsp;

## 1.1 History of the Automobile Industry in Canada 

Canada has a rich automotive history that is deeply connected to its economy. Between the first Canadian automobile produced in 1867 and the early United States (US) imports in 1898 (@CDNauto), Canada has been a player in the global market from the beginning. Canada welcomed the creation of Ford Motor Company of Canada Ltd in 1904, and by 1913, had roughly 50,000 vehicles on Canadian roads (@CDNauto). In the early 1920s, Canada had strengthened its hold on the market and was the second largest producer of vehicles in the world (@cvmaHistory). 

&nbsp;

Nowadays, Canada is still a significant competitor in the automobile market. However, it is not the behemoth it once was. Canada is the 8th largest automobile producer globally and is the third largest exporter after Japan and the US (@CDNauto). Canada is home to many different manufacturing plants, such as Ford, General Motors, Toyota, Honda, and Fiat-Chrysler (@CarsMadeInCan). These plants make massive contributions to Canada’s manufacturing sector, representing 12% of manufacturing gross domestic product (GDP) and 24% of manufacturing trade (@CDNauto). The industry itself employs roughly 130,000 people, mostly located in Ontario, and indirectly employs another 370,000 (@cvmaFacts).

&nbsp;

Canadians (and the Canadian economy) are dependent on automobiles. Every year, Canada exports \$65 billion worth of vehicles and $30 billion worth of parts (@CDNauto). The entire country has been built around the automobile, with cities being designed around roads, highways, and parking lots. There are currently over 35 million registered vehicles in Canada (@statsCan), nearly one registered car for every Canadian. Clearly, the automotive industry is a cornerstone in the Canadian economy. 

&nbsp;

Although 80% of cars produced in Canada are exported (@CDNauto), the high ratio of cars to people means domestic sales still make significant contributions to the economy. Since the beginning, there has been consistent growth in national sales for the Canadian auto industry – with a few exceptions (@newVehicleSales). In the early 1980s, there was a dramatic decrease in the number of new vehicles sold in Canada (@newVehicleSales). There are many factors that affect the number of vehicles sold in a country, but this paper will argue that the combination of high oil prices, inflation, and unemployment rates were what led to the dramatic decrease in Canadian automobile sales during the early 1980s. 

&nbsp;

## 1.2 Important Events in the 1970s and 1980s 

The 1970s were a period that saw 2 significant oil crises, the second of which contributed to a global recession (@GlobalRecessions). After World War II, the Allied powers created the state of Israel in the Middle East. Since then, there have been numerous wars between the Arabic and Israeli people. One of these wars was the Yom-Kippur War. It began in 1973 when Egypt and Syria launched an attack on Israel (@HistoryChannel). The Soviet-Union supported Egypt and Syria and the US backed Israel (@HistoryChannel). As an act of retaliation, the Organization of Arab Petroleum Exporting Countries (OAPEC) significantly reduced their oil production and created an oil embargo on the US (@HistoryChannel). This ban on trade and reduced production dramatically affected the price of oil, from \$2.70 USD per barrel in 1973 to $11.00 in 1974 (@oilPrices). This increase in price was felt globally and was enough to send countries not directly affected by the embargo into an energy crisis (@HistoryChannel). Although the trade ban was lifted in 1974, the price of oil stayed relatively high and did not fall back to pre-embargo levels (@oilPrices). 

&nbsp;

In 1979, the second dramatic increase in the price of oil occurred. Prices more than doubled from 1978 - 1979, from \$12.79 USD per barrel to $29.19 (@oilPrices). The late 1970s saw more civil unrest in the Middle East. The Iranian Revolution started in 1978 and ended in 1979 with the Shah of Iran being ousted by Ayatollah Khomeini (@AutomotiveNews, @Investopedia). Khomeini drastically reduced oil production, which reduced global shipments of crude oil (@AutomotiveNews). Due to the reduced supply, gasoline prices skyrocketed.

&nbsp;

Partly because of the dramatic increase in the price of oil, Canada was plunged into a deep recession during the early 1980s. The Iranian Revolution, paired with new monetary policy, led to a sharp decline in US production and an increase in unemployment rates (@GlobalRecessions). Since the US and Canadian economies were so tightly linked, Canadians felt the impact of the US’ decreased production and saw a dramatic increase in the unemployment rate as well. In 1981, unemployment was at 7.6%, but by 1982, this number had jumped to 11.0% (@UnemploymentCan). As the CBC said, “If they’re not building homes in Boston, they’re not cutting timber in BC” (@CBC). The increase in price of oil and new monetary policy eventually led to increasing rates of inflation around the world – including Canada (@GlobalRecessions, @inflation). Currently, the Bank of Canada tries to keep inflation between 1 and 3% (@BOC). In the early 1980s, inflation was at nearly 13% (@inflation). Combining the high inflation rate with a high unemployment rate meant Canadians were having difficulty purchasing groceries, heating their homes, and financing significant life events (@CBC). Without money for food, it is unlikely that many Canadians were considering purchasing an automobile at this time. 

&nbsp;

During the 1970s and early 1980s, domestic cars were the most popular in the market. These large, rear-wheel-drive, gas-guzzlers were fun to drive and were the favourites of the North American market (@AutomotiveNews). Smaller and more fuel-efficient Japanese cars were just starting to gain traction (@AutomotiveNews). Because favourite automobiles used a lot of gas, the price of gas was skyrocketing, inflation rates were increasing, and people could not find jobs, “consumer confidence evaporated” (@AutomotiveNews), and automobile sales were decimated in the early 1980s. 

&nbsp;

## 1.2 Structure of paper and method of analysis

This paper will try to confirm the research above using datasets provided by various sources. First, a surface level investigation into Canadian automobile sales, world oil prices, unemployment rates, and inflation levels will be done. Next, a Regression Discontinuity Design (RDD) model will be constructed to observe the dip in sales during the year of 1982 and a multiple linear regression model will be created to observe relationships between the different variables and total vehicle sales. The paper will then discuss results, possible weaknesses, and some next steps. Although the paper looks to draw a link between vehicle sales, oil prices, unemployment rates, and inflation, it will not be able to speak to causality of the dramatic decrease in autombile sales during the early 1980s. 

***THIS PART NEEDS TO BE BUILT UP*** WHY NO CAUSALITY??


# 2.0 Data

## 2.1 Datasets used 
In this analysis, four datasets were used. First, the "New Motor Vehicle Sales" dataset was used to determine the number of new vehicles sold in Canada (@newVehicleSales). Published by the Government of Alberta, this dataset records monthly provincial and national vehicle sales as far back as 1946; however, provincial data was not available until 1968. It was last updated in 2015, but the year is not complete. In order to allow for overlap with other datasets, only national data from 1960 to 2014 were included. Monthly vehicle sales were converted to yearly sales. This data comes from a reputable source, but only recorded *new* vehicle sales. Used car sales and gifted vehicles are not included in this analysis. 

```{r Cars,  echo = FALSE, message = FALSE, include = FALSE}

#read in the data
cars <- read_csv(here("inputs/data/newmotorvehiclesales.csv"))

#trim car sales data to what we need (exclude provinces)
cars_canada <- 
  cars %>% 
  select(When, Vehicle, Canada) %>% 
  mutate(date_when = as.Date(When, format="%m/%d/%Y")) %>% 
  mutate(Year = format(date_when, "%Y"))
```

```{r functions, echo = FALSE, message = FALSE, include = FALSE}

###FUNCTIONS###

# GOAL: group sales of trucks, cars, and total sales by year instead of month


# Total Truck Yearly Sales
total_trucks <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Trucks") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }
    

# Total Car Yearly Sales
total_cars <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Passenger cars") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }


# Total Sales
total_totals <- 
  function(year, dataset = cars_canada){
    temp_dataset <- 
      dataset %>% 
      filter(Year == year) %>%
      filter(Vehicle == "Total, new motor vehicles") 
    total <- sum(temp_dataset$Canada)
    return(total)
  }

```


```{r Yearly Vehicle Sales, echo = FALSE, message = FALSE, include = FALSE}

#Prepare the data frame for yearly vehicle sales
yearly_vehicle_sales = data.frame()

#run through every year (1960 - 2014), calculate the total yearly sales, add it to the data frame
  for (i in 1960:2014) {
    x <- total_trucks(i)
    y <- total_cars(i)
    z <- total_totals(i)
    newrow <- data.frame(Year = i, Trucks = x, Cars = y, Total = z)
    yearly_vehicle_sales <- rbind(yearly_vehicle_sales, newrow)
  }


#write to csv for local safekeeping
write_csv(yearly_vehicle_sales, here("inputs/data/yearly_vehicle_sales.csv"))


```
&nbsp; 
 
The second dataset used was historical oil prices from 1960 to 2021 (@oilPrices). The dataset was pulled from Statista and was published by Mineralölwirtschaftsverband (MWV), a German company which "[represents] the petroleum industry in legal matters, particularly in the preparation of laws and regulations" (@MWV). MWV monitors world oil prices, particularly the price of crude oil from the Organization of the Petroleum Exporting Countries (OPEC). In order to fit with other data used in this study, only the years 1960 to 2014 were selected. There is some discrepancies between this dataset and the study. This monitors the oil price from OPEC --  not historic Canadian prices. Unfortunately, data on historical Canadian oil prices (within the right time frame) could not be found. Regardless, trends are related between the two, and OPEC prices will hold as a valid substitute. 


```{r Oil, echo = FALSE, message = FALSE, include = FALSE}

#read in data
oil <- read_csv(here("inputs/data/OPEC_Historic_Oil_Prices_Statista_CSV.csv"))

#Trim oil price range to match that of car data (up to 2014)
oil_trimmed <- 
  oil %>% 
  filter(`OPEC oil price annually 1960-2021` <= 2014) %>% 
  rename(c('Year' = 'OPEC oil price annually 1960-2021')) %>% 
  rename(c('price_in_usd' = "X2"))

#Change oil price year from character to numeric
oil_trimmed$Year <- as.numeric(as.character(oil_trimmed$Year))
```
&nbsp; 

The third dataset used for this analysis was for Canadian unemployment rates (@UnemploymentCan). The dataset was published by Statistics Canada, drawing on information learned from Labour Force Surveys. Information from 1976 - 2018 was collected, which was all that was available. The original dataset was quite large, holding information about the entire Labour Force. It was trimmed to different variables of interest. First, only national unemployment rates were selected. Other labour force statistics were ignored, and provincial data was disregarded. In terms of demographics, unemployment rates for both sexes above the age of 15 were selected. This was selected to get a good idea of how the Canada's labour force was functioning at the time of interest. It is noted, though, that it is unlikely for 15 year olds to be purchasing new vechiles. 

```{r Unemployment, echo = FALSE, message = FALSE, include = FALSE}

#read in data
unemployment <- read_csv(here("inputs/data/unemployment_rates_can.csv"))

#Cleaning the unemployment rate data set
unemployment_cleaned <- 
  unemployment %>%
  clean_names() %>% 
  filter(geo == 'Canada' & 
           sex == 'Both sexes' & 
           age_group == '15 years and over' & 
           labour_force_characteristics == 'Unemployment rate') %>% 
  select(c(ref_date, geo, labour_force_characteristics, age_group, sex, value ))

#trim to columns of interest
unemployment_trimmed <- 
  unemployment_cleaned %>% 
  select(c(ref_date, value)) %>% 
  rename(c('Year' = 'ref_date')) %>% 
  rename(c('unemployment_rate' = 'value'))

```

&nbsp; 

The last dataset was created by the analyst. Data was pulled from inflation.eu (@infeu1). Inflation.eu "contains current and historic data about inflation and the consumer price index", citing Statistics Canada as its source for Canadian data (@infeu2). Data was copied from the historic data web page into a csv file in order to run the analysis.    

```{r Inflation, echo = FALSE, message = FALSE, include = FALSE}

#read in data
inflation_rates <- read_csv(here("inputs/data/Inflation_Rates.csv"))

#Inflation Rates Cleaning 
inflation_rates_cleaned <- 
  inflation_rates %>% 
    filter(Year <= 2014 & Year >= 1960)

```


## 2.2 How Data was Analyzed 
Data was analyzed using R(@R). Many packages were used to study the data, with tidyverse doing much of the heavy lifting (@tidyverse). Janitor (@Janitor) was used to clean datasets. Here (@here) helped in locating and saving files. Ggplot2 (@ggplot2) and gridExtra (@gridExtra) were used to create graphs and figures. Tinytex (@tinytex) was used to help write the output to PDF. Finally, bibtex (@bibtex) was used for citations. 


## 2.3 Show me the money! 

```{r Car Sales, fig.cap="Historical Car Sales in Canada", echo = FALSE, message = FALSE}

ggplot(yearly_vehicle_sales, aes(x = Year, y = Cars)) +
  theme_minimal() + 
  geom_point() +
  geom_line() + 
  labs(x = "Year", 
       y = "Number of New Cars Sold",
       title = "Canadian Car Sales")

```

```{r Truck Sales, fig.cap="Historical Truck Sales in Canada", echo = FALSE, message = FALSE}

ggplot(yearly_vehicle_sales, aes(x = Year, y = Trucks)) +
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Number of New Trucks Sold",
       title = "Canadian Truck Sales")


```


```{r Vehicle Sales, fig.cap="Historical Total Automobile Sales in Canada", echo = FALSE, message = FALSE}

ggplot(yearly_vehicle_sales, aes(x = Year, y = Total)) +
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Total Number of New Vehicles Sold",
       title = "Total Vehicles Sold")


```


```{r Oil Plot, fig.cap="Historical Oil Prices", echo = FALSE, message = FALSE}

ggplot(oil_trimmed, aes(x = Year, y = price_in_usd )) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() +
  theme(axis.text.x = element_text(angle = 90)) + 
  labs(x = "Year", 
       y = "OPEC Price of Oil (per barrel, in USD", 
       title = "OPEC World Oil Prices")


```



```{r Unemployment Plot, fig.cap="Unemployment Rates in Canada", echo = FALSE, message = FALSE}

ggplot(unemployment_trimmed, aes(x = Year, y = unemployment_rate )) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Unemployment Rate (% of Labour Force)",
       title = "Unemployment Rates in Canada")

```


```{r Inflation Plot, fig.cap="Inflation Rates in Canada", echo = FALSE, message = FALSE}

ggplot(inflation_rates_cleaned, aes(x = Year, y = inflation_rate)) + 
  theme_minimal() + 
  geom_point() + 
  geom_line() + 
  labs(x = "Year", 
       y = "Inflation Rate (%)",
       title = "Inflation Rates in Canada")

```

# 3.0 Model 
```{r RDD1982, echo = FALSE, message = FALSE, fig.cap="RDD for Auto Sales and Year"}

#Total RDD split on year
yearly_vehicle_sales %>% 
  ggplot(aes(x = Year,
             y = Total)) +
  geom_point(alpha = 0.2) +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year < 1982), 
              method='lm',
              color = "black") +
  geom_smooth(data = yearly_vehicle_sales %>% filter(Year >= 1982), 
              method='lm',
              color = "black") +
  theme_minimal() +
  labs(x = "Year",
       y = "Number of Vehicles Sold",
       title = "RDD TEMP")

```

```{r Linear Model Oil Price Car Sales, echo = FALSE, include = FALSE, message = FALSE, include = FALSE}

#For all years: 

lm_data_oil_yearly_vehicle_sales <- 
  inner_join(yearly_vehicle_sales, oil_trimmed, by = "Year")

linear_model_oil_and_sales <- 
  lm(Total ~ price_in_usd, lm_data_oil_yearly_vehicle_sales)

summary(linear_model_oil_and_sales)

ggplot(lm_data_oil_yearly_vehicle_sales, aes(x = price_in_usd, y = Total)) +
  geom_point() +
  theme_minimal()



```

```{r Linear Model unemployment and sales, echo = FALSE, include = FALSE, message = FALSE}

oil_sales_unemp_dataset <- 
  inner_join(unemployment_trimmed, lm_data_oil_yearly_vehicle_sales, by = "Year")

ggplot(oil_sales_unemp_dataset, aes(unemployment_rate, Total)) + 
  geom_point() + 
  theme_minimal()

unemployment_rate_lm_sales <- 
  lm(Total ~ unemployment_rate, oil_sales_unemp_dataset )

summary(unemployment_rate_lm_sales)

```


```{r Linear Model Inflation and sales, echo = FALSE, include = FALSE, message = FALSE}

#Inflation testing 

oil_sales_unemp_inf_dataset <- 
  inner_join(oil_sales_unemp_dataset, inflation_rates_cleaned, by = "Year")

ggplot(oil_sales_unemp_inf_dataset, aes(x = inflation_rate, y = Total)) +
  geom_point() +
  theme_minimal()

linear_model_inflation_sales <- 
  lm(Total ~ inflation_rate, oil_sales_unemp_inf_dataset)

summary(linear_model_inflation_sales)

```



```{r Multiple Linear Regression, echo = FALSE, include = FALSE, message = FALSE}

multiple_lm_model_all_3 <- 
  lm(Total ~ unemployment_rate + price_in_usd + inflation_rate, 
     data = oil_sales_unemp_inf_dataset)

summary(multiple_lm_model_all_3)


```

```{r Unemployment Oil Sales lm, echo = FALSE, include = FALSE, message = FALSE}

#build a linear model with both unemployment and price of oil. 

lm_oil_unemployment_sales <- 
  lm(Total ~ unemployment_rate + price_in_usd, 
     data = oil_sales_unemp_inf_dataset)

summary(lm_oil_unemployment_sales)

```

```{r Inflation Oil Sales lm, echo = FALSE, include = FALSE, message = FALSE}
lm_oil_inflation_sales <- 
  lm(Total ~ inflation_rate + price_in_usd, 
     data = oil_sales_unemp_inf_dataset)

summary(lm_oil_inflation_sales)

```

```{r Unemployment Inflation Sales lm, echo = FALSE, include = FALSE, message = FALSE}
lm_inflation_unemployment_sales <- 
  lm(Total ~ inflation_rate + unemployment_rate, 
     data = oil_sales_unemp_inf_dataset)

summary(lm_inflation_unemployment_sales)
```


# 4.0 Results



# 5.0 Discussion 

#5.1 Ethics
- this data only focusses on new vehicle sales. Lots of people will never purchase a new vechile in their life. It is possible that those who are buying new cars are wealthy enough to not be as affected by factsors such as inflation and oil prices. 

&nbsp;

## 5.1 Weaknesses

&nbsp;

## 5.2 Next Steps


# 6.0 Conclusion 



# Appendix



# References





